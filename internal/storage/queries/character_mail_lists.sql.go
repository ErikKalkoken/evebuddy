// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.26.0
// source: character_mail_lists.sql

package queries

import (
	"context"
)

const createCharacterMailList = `-- name: CreateCharacterMailList :exec
INSERT OR IGNORE INTO character_mail_lists (
    character_id,
    eve_entity_id
)
VALUES (
    ?, ?
)
`

type CreateCharacterMailListParams struct {
	CharacterID int64
	EveEntityID int64
}

func (q *Queries) CreateCharacterMailList(ctx context.Context, arg CreateCharacterMailListParams) error {
	_, err := q.db.ExecContext(ctx, createCharacterMailList, arg.CharacterID, arg.EveEntityID)
	return err
}

const deleteObsoleteCharacterMailLists = `-- name: DeleteObsoleteCharacterMailLists :exec
DELETE FROM character_mail_lists
WHERE character_mail_lists.character_id = ?
AND eve_entity_id NOT IN (
    SELECT eve_entity_id
    FROM character_mails_recipients
    JOIN character_mails ON character_mails.id = character_mails_recipients.mail_id
    WHERE character_mails.character_id = ?
)
AND eve_entity_id NOT IN (
    SELECT from_id
    FROM character_mails
    WHERE character_mails.character_id = ?
)
`

type DeleteObsoleteCharacterMailListsParams struct {
	CharacterID   int64
	CharacterID_2 int64
	CharacterID_3 int64
}

func (q *Queries) DeleteObsoleteCharacterMailLists(ctx context.Context, arg DeleteObsoleteCharacterMailListsParams) error {
	_, err := q.db.ExecContext(ctx, deleteObsoleteCharacterMailLists, arg.CharacterID, arg.CharacterID_2, arg.CharacterID_3)
	return err
}

const getCharacterMailList = `-- name: GetCharacterMailList :one
SELECT character_id, eve_entity_id
FROM character_mail_lists
WHERE character_id = ? AND eve_entity_id = ?
`

type GetCharacterMailListParams struct {
	CharacterID int64
	EveEntityID int64
}

func (q *Queries) GetCharacterMailList(ctx context.Context, arg GetCharacterMailListParams) (CharacterMailList, error) {
	row := q.db.QueryRowContext(ctx, getCharacterMailList, arg.CharacterID, arg.EveEntityID)
	var i CharacterMailList
	err := row.Scan(&i.CharacterID, &i.EveEntityID)
	return i, err
}

const listCharacterMailListsOrdered = `-- name: ListCharacterMailListsOrdered :many
SELECT eve_entities.id, eve_entities.category, eve_entities.name
FROM character_mail_lists
JOIN eve_entities ON eve_entities.id = character_mail_lists.eve_entity_id
WHERE character_id = ?
ORDER by eve_entities.name
`

func (q *Queries) ListCharacterMailListsOrdered(ctx context.Context, characterID int64) ([]EveEntity, error) {
	rows, err := q.db.QueryContext(ctx, listCharacterMailListsOrdered, characterID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []EveEntity
	for rows.Next() {
		var i EveEntity
		if err := rows.Scan(&i.ID, &i.Category, &i.Name); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
